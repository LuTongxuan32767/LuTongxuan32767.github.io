if(window.zhszTbrwXz){alert("zhszTbrwXz 冲突了！")}else{window.zhszTbrwXz={}}$.extend(zhszTbrwXz,{koObj:{tbrwInfo:ko.observableArray()},getTbrwInfo:function(){$.post(zhszTbrwXzConst.tbrwAjaxUrl,{method:"queryXfrwList",},function(e){if(e==""){document.getElementById("pop_task").style.display="none";document.getElementById("pop_fade").style.display="none";return}if(e=="1"){document.getElementById("pop_task").style.display="none";document.getElementById("pop_fade").style.display="none";sessionStorage.setItem("tbrwSfxz","yes");return}zhszTbrwXz.koObj.tbrwInfo.removeAll();var b=e.rows;if(b.length<=1){document.getElementById("pop_task").style.display="none";document.getElementById("pop_fade").style.display="none";sessionStorage.setItem("tbrwSfxz","yes")}else{for(var a=0;a<b.length;a++){var d=b[a];var f=parseInt(d.xn)+"-"+(parseInt(d.xn)+1);var c=d.xq==1?"上学期":"下学期";zhszTbrwXz.koObj.tbrwInfo.push({nr:f+""+c,tbrwId:d.tbrwId,})}document.getElementById("pop_task").style.display="block";document.getElementById("pop_fade").style.display="block"}}).error(function(a){E5.Msg.alert("填报任务查询失败！");return false})},saveTbrw:function(tbrwId){if(tbrwId==undefined||tbrwId==""||tbrwId==null){E5.Msg.alert("请选择填报任务!");return}$.post(zhszTbrwXzConst.tbrwAjaxUrl,{method:"saveTbrw",tbrwId:tbrwId,},function(data){if(data=="1"){document.getElementById("pop_task").style.display="none";document.getElementById("pop_fade").style.display="none";sessionStorage.setItem("tbrwSfxz","yes");var dqUrl=window.location.href;window.location.href=dqUrl}}).error(function(msg){var error=eval("("+msg.responseText+")");E5.Msg.alert(error.message);return false})},});$(function(){$("#tbrwButton").on("click",function(){var c=$('input[name="tbrwRadios"]:checked').val();zhszTbrwXz.saveTbrw(c)});var a=document.getElementById("tbrwXz");if(a){ko.applyBindings(zhszTbrwXz.koObj,a)}window.addEventListener("storage",function(c){if(c.key=="storeSessionZx"){sessionStorage.removeItem("tbrwSfxz")}});var b=sessionStorage.getItem("tbrwSfxz");if(!(b!=null&&b!=undefined&&""!=b&&"yes"==b)){zhszTbrwXz.getTbrwInfo()}});